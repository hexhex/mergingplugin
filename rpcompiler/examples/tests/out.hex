% -------------------- Mappings for belief bases -------------------- 
% Belief base "bb1"
sources(bb1, AnswerNr) :- &hex["
     p1(a).
", ""](AnswerNr).
% Belief base "bb2"
sources(bb2, AnswerNr) :- &hex["
     x v p1(y).
", ""](AnswerNr).


% -------------------- Revision plan -------------------- 
% Using belief base bb2
results(result_bb2, AnswerNr) :- sources(bb2, AnswerNr).

% Final result
finalresult(AnswerNr) :- results(result_bb2, AnswerNr).


% ---------- Extraction of final answer sets ---------- 
finalanswersets(AnswerNr, AnswerSetNr) :- finalresult(AnswerNr), &answersets[AnswerNr](AnswerSetNr).
% Each answer set can be selected or not
selectedas(AnswerSetNr) v -selectedas(AnswerSetNr) :- finalanswersets(AnswerNr, AnswerSetNr).

% Select exactly one:
%    Select at least one
atleastoneasselected :- selectedas(AnswerSetNr).
:- not atleastoneasselected.
%    Select at most one
:- selectedas(AnswerSetNr1), selectedas(AnswerSetNr2), AnswerSetNr1 != AnswerSetNr2.

% Take content of the selected virtual answer set and transfer it into the "real" answer sets of the hex program
%    p1 with arity 1
p1(Arg0) :- finalresult(AnswerNr), selectedas(AnswerSetNr), &arguments[AnswerNr, AnswerSetNr, "p1"](RunningNr, 0, Arg0).
%    x with arity 0
x :- finalresult(AnswerNr), selectedas(AnswerSetNr), &tuples[AnswerNr, AnswerSetNr](x, 0).


% -------------------- Additional information --------------------
% dlvhex call:
%   dlvhex -filter=p1,x [name of hex file]
